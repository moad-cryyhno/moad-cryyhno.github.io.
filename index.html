<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø®ØªØ¨Ø§Ø± Ù„ÙŠØ¨ÙŠØŸ</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root {
    --primary: #0b3d91;
    --secondary: #c9a227;
    --bg-gradient: radial-gradient(circle at center, #0b3d91 0%, #021c4a 100%);
    --btn-shadow: #9e7e1a;
}

body.dark-theme {
    --primary: #c9a227;
    --secondary: #0b3d91;
    --bg-gradient: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
    --btn-shadow: #051a3d;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    margin: 0; font-family: 'Cairo', sans-serif;
    background: var(--bg-gradient);
    color: white; min-height: 100vh; overflow-y: auto;
}

.section {
    position: absolute; top: 0; right: 0; width: 100%; min-height: 100vh;
    padding: 20px; display: none; opacity: 0; transform: translateY(10px);
    transition: 0.4s ease-in-out;
}
.section.active { display: block; opacity: 1; transform: translateY(0); }

.title { font-size: 32px; font-weight: 900; margin-bottom: 25px; text-align: center; color: var(--secondary); text-shadow: 0 4px 10px rgba(0,0,0,0.3); }

/* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù…Ø¹ ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¶ØºØ· 3D */
.btn {
    width: 100%; padding: 18px; margin-bottom: 15px; border: none; border-radius: 20px;
    background: var(--secondary); color: white; font-size: 18px; font-weight: 700;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    box-shadow: 0 8px 0 var(--btn-shadow);
    position: relative; top: 0; transition: 0.1s ease;
}
.btn:active:not(:disabled) { top: 6px; box-shadow: 0 2px 0 var(--btn-shadow); }
.btn:disabled { opacity: 0.7; cursor: not-allowed; }

/* Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ù…ØµÙ„Ø­Ø© */
#certCanvas {
    background: #fffcf2 !important; 
    color: #0b3d91 !important;
    border: 12px double #c9a227; border-radius: 8px;
    padding: 40px 20px; text-align: center; position: relative;
    max-width: 480px; margin: 20px auto 40px auto;
    box-shadow: 0 20px 50px rgba(0,0,0,0.5);
}
#certCanvas * { color: #0b3d91 !important; }

.cert-table { width: 100%; margin: 20px 0; border-collapse: collapse; }
.cert-table td { 
    border: 1px solid rgba(201, 162, 39, 0.4); 
    padding: 12px; font-weight: bold; font-size: 14px;
    background: rgba(255,255,255,0.6);
}

.stars { color: #f1c40f !important; font-size: 24px; margin: 10px 0; letter-spacing: 3px; }

.stamp-area { display: flex; justify-content: space-around; align-items: center; margin-top: 30px; }
.official-stamp { 
    width: 85px; height: 85px; border: 3px dashed #c9a227; border-radius: 50%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    font-size: 10px; font-weight: 900; color: #c9a227 !important; transform: rotate(-10deg);
}
.signature-box { text-align: center; }
.sig-line { border-top: 2px solid #0b3d91; width: 140px; margin: 5px auto 0; padding-top: 5px; font-size: 12px; }
</style>
</head>
<body>

<div class="section active" id="home">
    <div class="title">Ø§Ø®ØªØ¨Ø§Ø± Ù„ÙŠØ¨ÙŠØŸ</div>
    <button class="btn" onclick="show('profile')"><i class="fa-solid fa-id-card"></i> Ù‡ÙˆÙŠØªÙŠ</button>
    <button class="btn" onclick="startQuiz()"><i class="fa-solid fa-play"></i> Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ</button>
    <button class="btn" style="background:#444; box-shadow:0 8px 0 #222" onclick="show('settings')"><i class="fa-solid fa-gear"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    <p style="text-align:center; opacity:0.6; margin-top:40px;">ØªØµÙ…ÙŠÙ…: Ù…Ø¹Ø§Ø° Ø§Ø¨ÙˆØµØ¨ÙŠØ¹ | Moad Muhammad ğŸ‡±ğŸ‡¾</p>
</div>

<div class="section" id="profile">
    <div class="title">Ù…Ù† Ø§Ù„ÙØ§Ù„Ø­ØŸ</div>
    <input type="text" id="userName" style="width:100%; padding:18px; border-radius:15px; border:2px solid var(--secondary); margin-bottom:20px; font-family:'Cairo'; text-align:center;" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">
    <button class="btn" onclick="saveName()">Ø­ÙØ¸ ÙˆØ§Ø³ØªÙ…Ù€Ø±</button>
</div>

<div class="section" id="settings">
    <div class="title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
    <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 25px;">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;"><span>Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</span><input type="checkbox" id="darkToggle" onchange="toggleTheme()"></div>
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;"><span>Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø°ÙƒÙŠ</span><input type="checkbox" id="timerToggle" checked></div>
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;"><span>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª</span><input type="range" id="volRange" min="0" max="1" step="0.1" value="0.5"></div>
        <div style="display:flex; justify-content:space-between;"><span>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span><select id="qCount"><option value="5">5 Ø£Ø³Ø¦Ù„Ø©</option><option value="8">8 Ø£Ø³Ø¦Ù„Ø©</option></select></div>
    </div>
    <br><button class="btn" onclick="show('home')">ØªÙ…</button>
</div>

<div class="section" id="quiz">
    <div id="timerDisplay" style="text-align:center; font-weight:900; color:var(--secondary); font-size:28px; margin-bottom:10px;">10</div>
    <div style="height:12px; background:rgba(255,255,255,0.1); border-radius:10px; margin-bottom:25px; overflow:hidden;">
        <div id="prog" style="height:100%; width:0%; background:var(--secondary); transition:0.4s;"></div>
    </div>
    <div id="qText" class="title" style="font-size:22px; color:white; min-height:80px;"></div>
    <div id="ansBox"></div>
</div>

<div class="section" id="result">
    <div id="certCanvas">
        <div style="font-size:26px; font-weight:900; margin-bottom:5px;">Ø´Ù‡Ø§Ø¯Ø© ÙƒÙØ§Ø¡Ø© ÙˆØ·Ù†ÙŠØ©</div>
        <div style="font-size:13px; opacity:0.8; margin-bottom:15px;">ÙÙŠ Ø§Ù„ØªØ±Ø§Ø« ÙˆØ§Ù„Ø«Ù‚Ø§ÙØ© Ø§Ù„Ù„ÙŠØ¨ÙŠØ©</div>
        
        <p style="margin:5px 0; font-size:14px;">ÙŠÙØ´Ù‡Ø¯ Ù…Ø±ÙƒØ² "Ø§Ø®ØªØ¨Ø§Ø± Ù„ÙŠØ¨ÙŠØŸ" Ø¨Ø£Ù† Ø§Ù„Ù…Ø¨Ø¯Ø¹:</p>
        <h2 id="finalName" style="margin:10px 0; font-size:28px;"></h2>
        
        <div class="stars" id="starRank"></div>

        <table class="cert-table">
            <tr>
                <td>Ø§Ù„Ø¯Ø±Ø¬Ø©: <span id="cScore"></span></td>
                <td>Ø§Ù„Ù†Ø³Ø¨Ø©: <span id="cPercent"></span></td>
            </tr>
            <tr>
                <td>Ø§Ù„ØªÙ‚Ø¯ÙŠØ±: <span id="cGradeText"></span></td>
                <td>Ø§Ù„ØªØ§Ø±ÙŠØ®: <span id="cDate"></span></td>
            </tr>
        </table>

        <div id="rankBadge" style="background:#0b3d91; color:white !important; padding:12px; border-radius:10px; font-weight:900; display:inline-block; margin-bottom:15px;"></div>
        
        <div id="cWisdom" style="font-size:12px; font-style:italic; border-top:1px dashed #ccc; padding-top:10px;"></div>

        <div class="stamp-area">
            <div class="official-stamp">Ø®ØªÙ… Ø§Ù„Ø¬ÙˆØ¯Ø©<br>Ù…Ø¹ØªÙ…Ø¯ 2026</div>
            <div class="signature-box">
                <div style="font-family:cursive; font-size:18px;">Moad Muhammad</div>
                <div class="sig-line">ØªÙˆÙ‚ÙŠØ¹: Ù…Ø¹Ø§Ø° Ø§Ø¨ÙˆØµØ¨ÙŠØ¹</div>
            </div>
        </div>
    </div>

    <div style="margin-top: 30px; padding-bottom: 40px;">
        <button class="btn" onclick="download()"><i class="fa-solid fa-image"></i> Ø­ÙØ¸ ÙƒØµÙˆØ±Ø© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©</button>
        <button class="btn" style="background:#444; box-shadow:0 8px 0 #222" onclick="location.reload()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>
</div>

<script>
let isProcessing = false;
const aCtx = new (window.AudioContext || window.webkitAudioContext)();

function playBeep(f, d) {
    const v = document.getElementById('volRange').value;
    if(v == 0) return;
    const o = aCtx.createOscillator(), g = aCtx.createGain();
    o.frequency.value = f; g.gain.value = v * 0.1;
    o.connect(g); g.connect(aCtx.destination);
    o.start(); o.stop(aCtx.currentTime + d);
}

function playClick() { playBeep(1000, 0.05); }

const questions = [
    {q:"Ø´Ù† Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© 'Ø·Ø§Ø³Ø©'ØŸ", a:["ØµØ­Ù†","ÙƒÙˆØ¨","Ù…Ù„Ø¹Ù‚Ø©"], c:1},
    {q:"Ø§Ù„Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù„Ù„ÙŠØ¨ÙŠØ§ Ù‡ÙŠØŸ", a:["Ø·Ø±Ø§Ø¨Ù„Ø³","Ù…ØµØ±Ø§ØªØ©","Ø¨Ù†ØºØ§Ø²ÙŠ"], c:2},
    {q:"Ø´Ù† Ù‡ÙŠ 'Ø§Ù„Ù‚Ø±Ù‚ÙˆØ´Ø©'ØŸ", a:["Ø­Ù„ÙˆÙŠØ§Øª","Ù„Ø­Ù… Ù…Ø¬ÙÙ","Ø®Ø¨Ø² ÙŠØ§Ø¨Ø³"], c:1},
    {q:"ÙŠØ³ØªØ®Ø¯Ù… 'Ø§Ù„Ù…Ù‡Ø±Ø§Ø³' ÙÙŠØŸ", a:["Ø´Ø±Ø¨ Ø§Ù„Ù…Ø§Ø¡","Ø·Ø­Ù† Ø§Ù„ØªÙˆØ§Ø¨Ù„","Ø§Ù„Ø²ÙŠÙ†Ø©"], c:1},
    {q:"Ø£ÙŠÙ† ÙŠÙˆØ¬Ø¯ Ø¬Ø¨Ù„ 'Ø£ÙƒØ§ÙƒÙˆØ³'ØŸ", a:["ÙÙŠ Ø§Ù„Ø´Ø±Ù‚","ÙÙŠ Ø§Ù„Ø¬Ù†ÙˆØ¨","ÙÙŠ Ø§Ù„ØºØ±Ø¨"], c:1},
    {q:"Ø£ÙƒÙ„Ø© Ù„ÙŠØ¨ÙŠØ© Ù…Ø´Ù‡ÙˆØ±Ø© ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø©ØŸ", a:["Ø±Ø²","ÙƒØ³ÙƒØ³ÙŠ","Ù…Ø¨ÙƒØ¨ÙƒØ©"], c:1}
];

const wisdoms = ["Â« Ø§Ù„Ù„ÙŠ Ù„ÙŠÙƒ Ù„ÙŠÙƒØŒ ÙˆØ§Ù„Ù„ÙŠ Ù„ØºÙŠØ±Ùƒ ÙŠØ­Ø±Ù… Ø¹Ù„ÙŠÙƒ Â»", "Â« Ø§Ù„ØµØ¨Ø± Ù…ÙØªØ§Ø­ Ø§Ù„ÙØ±Ø¬ Â»", "Â« Ø¯ÙŠØ± Ø§Ù„Ø®ÙŠØ± ÙˆØ§Ù†Ø³Ø§Ù‡ Â»"];

let cur = 0, score = 0, activeQs = [], timer;

function show(id) {
    playClick();
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

function saveName() {
    localStorage.setItem("uname", document.getElementById("userName").value);
    show('home');
}

function toggleTheme() {
    document.body.classList.toggle('dark-theme');
    localStorage.setItem('dark', document.getElementById('darkToggle').checked);
}

function startQuiz() {
    cur = 0; score = 0;
    activeQs = questions.sort(() => 0.5 - Math.random()).slice(0, document.getElementById("qCount").value);
    show('quiz'); loadQ();
}

function loadQ() {
    isProcessing = false;
    clearInterval(timer);
    if(cur >= activeQs.length) return finish();
    
    document.getElementById("prog").style.width = (cur/activeQs.length)*100 + "%";
    document.getElementById("qText").innerText = activeQs[cur].q;
    const box = document.getElementById("ansBox"); box.innerHTML = "";
    
    activeQs[cur].a.forEach((a, i) => {
        const b = document.createElement("button"); b.className = "btn";
        b.innerText = a; b.onclick = () => check(b, i);
        box.appendChild(b);
    });

    if(document.getElementById('timerToggle').checked) startTimer();
    else document.getElementById('timerDisplay').style.display = 'none';
}

function startTimer() {
    let t = 10;
    const d = document.getElementById('timerDisplay');
    d.style.display = 'block'; d.innerText = t;
    timer = setInterval(() => {
        t--; d.innerText = t;
        if(t <= 0) { clearInterval(timer); check(null, -1); }
    }, 1000);
}

function check(btn, i) {
    if(isProcessing) return;
    isProcessing = true;
    clearInterval(timer);
    
    if(btn && i === activeQs[cur].c) {
        score++; btn.style.background = "#27ae60"; playBeep(600, 0.1);
    } else if(btn) {
        btn.style.background = "#e74c3c"; playBeep(200, 0.2);
    }
    
    cur++;
    setTimeout(loadQ, 800);
}

function finish() {
    show('result');
    const p = Math.round((score/activeQs.length)*100);
    document.getElementById("finalName").innerText = localStorage.getItem("uname") || "Ø¨Ø·Ù„ Ù…Ø¬Ù‡ÙˆÙ„";
    document.getElementById("cScore").innerText = score + " / " + activeQs.length;
    document.getElementById("cPercent").innerText = p + "%";
    document.getElementById("cDate").innerText = new Date().toLocaleDateString('ar-LY');
    document.getElementById("cWisdom").innerText = wisdoms[Math.floor(Math.random()*wisdoms.length)];
    
    let stars = "", rank = "", grade = "";
    if(p === 100) { stars = "â˜…â˜…â˜…â˜…â˜…"; rank = "Ù„ÙŠØ¨ÙŠ Ø£ØµÙ„ÙŠ ğŸ‘‘"; grade = "Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹"; confetti(); }
    else if(p >= 75) { stars = "â˜…â˜…â˜…â˜…â˜†"; rank = "ÙˆÙ„Ø¯ Ø¨Ù„Ø§Ø¯ ÙØ§Ù„Ø­ ğŸ’ª"; grade = "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹"; }
    else if(p >= 50) { stars = "â˜…â˜…â˜…â˜†â˜†"; rank = "Ù„ÙŠØ¨ÙŠ Ø¨Ø§Ù„Ø¨Ø±ÙƒØ© ğŸ¤"; grade = "Ù…Ù‚Ø¨ÙˆÙ„"; }
    else { stars = "â˜…â˜†â˜†â˜†â˜†"; rank = "Ø³ÙŠØ§Ø­Ø© ÙÙŠ Ø¨Ù„Ø§Ø¯Ù†Ø§"; grade = "Ø¶Ø¹ÙŠÙ"; }
    
    document.getElementById("starRank").innerText = stars;
    document.getElementById("rankBadge").innerText = "Ø§Ù„Ø±ØªØ¨Ø©: " + rank;
    document.getElementById("cGradeText").innerText = grade;
}

function download() {
    playClick();
    html2canvas(document.getElementById("certCanvas"), { scale: 3, backgroundColor: "#fffcf2" }).then(canvas => {
        const link = document.createElement("a");
        link.download = "Ø´Ù‡Ø§Ø¯Ø©_Ù…Ø¹Ø§Ø°.png";
        link.href = canvas.toDataURL();
        link.click();
    });
}

if(localStorage.getItem('dark') === 'true') {
    document.getElementById('darkToggle').checked = true;
    toggleTheme();
}
</script>
</body>
  </html>
  
